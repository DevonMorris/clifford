# 2D Conformal Geometric Algebra
# Cl(3,1,0) - Embeds 2D Euclidean space into 4D conformal space
# Reference: https://conformalgeometricalgebra.org/wiki/index.php?title=Main_Page

[algebra]
complete = false
name = "conformal2"
module_path = "conformal/dim2"
description = "2D Conformal Geometric Algebra Cl(3,1,0)"

[signature]
positive = ["e1", "e2", "e3"]
negative = ["e4"]
zero = []

[norm]
# Conformal GA uses reverse for norm (non-degenerate algebra)
# Note: This gives an indefinite norm (can be positive, negative, or zero)
# Null vectors (norm = 0) represent actual geometric points
primary_involution = "reverse"

# ============================================================
# Types (following conformalgeometricalgebra.org conventions)
# ============================================================

[types.Scalar]
grades = [0]
description = "Scalar (grade-0 element)"
field_map = [
  { name = "s", blade = "s" }
]

[types.RoundPoint]
grades = [1]
description = "Round point (null vectors represent actual 2D points)"
# Semantic field names:
# x, y: Euclidean coordinates
# o: origin weight (e3 coefficient)
# i: infinity weight (e4 coefficient)
field_map = [
  { name = "x", blade = "e1" },
  { name = "y", blade = "e2" },
  { name = "o", blade = "e3" },
  { name = "i", blade = "e4" }
]

[types.PointPair]
grades = [2]
description = "Point pair / dipole (two points or oriented line segment)"
# Blade order by bitmask: e12, e13, e23, e14, e24, e34
# m: moment (spatial bivector e12)
# ox, oy: origin bivectors (e3 wedge ei: e13, e23)
# ix, iy: infinity bivectors (e4 wedge ei: e14, e24)
# oi: origin-infinity bivector (e34)
field_map = [
  { name = "m", blade = "e12" },
  { name = "ox", blade = "e13" },
  { name = "oy", blade = "e23" },
  { name = "ix", blade = "e14" },
  { name = "iy", blade = "e24" },
  { name = "oi", blade = "e34" }
]

[types.Circle]
grades = [3]
description = "Circle in 2D space (or line as circle through infinity)"
# Blade order by bitmask: e123, e124, e134, e234
# w: weight (e123 coefficient - Euclidean trivector)
# cx, cy: center encoding (e124, e134 - with e4)
# r: radius encoding (e234 - all with e4)
field_map = [
  { name = "w", blade = "e123" },
  { name = "cx", blade = "e124" },
  { name = "cy", blade = "e134" },
  { name = "r", blade = "e234" }
]
# Circle inversion: C × P × C⁻¹ inverts points through the circle
inverse_sandwich_targets = ["RoundPoint", "Circle"]

[types.Pseudoscalar]
grades = [4]
description = "Pseudoscalar (oriented 4-volume)"
field_map = [
  { name = "xyoi", blade = "e1234" }
]

[types.Motor]
grades = [0, 2, 4]
description = "Motor (even subalgebra for conformal transformations)"
# Grade 0: s (scalar)
# Grade 2: same as PointPair - m, ox, oy, ix, iy, oi
# Grade 4: ps (pseudoscalar)
field_map = [
  { name = "s", blade = "s" },
  { name = "m", blade = "e12" },
  { name = "ox", blade = "e13" },
  { name = "oy", blade = "e23" },
  { name = "ix", blade = "e14" },
  { name = "iy", blade = "e24" },
  { name = "oi", blade = "e34" },
  { name = "ps", blade = "e1234" }
]

# ============================================================
# Sparse Types (subset of blades within a grade)
# These types are constrained versions of the full types above.
# ============================================================

# Line = Circle through infinity (w=0)
# Uses only 3 of the 4 grade-3 blades (excluding e123)
[types.Line]
grades = [3]
description = "Line (circle through infinity, w=0)"
field_map = [
  { name = "nx", blade = "e124" },
  { name = "ny", blade = "e134" },
  { name = "d", blade = "e234" }
]

# FlatPoint = PointPair with only e4 components
# Uses only 3 of the 6 grade-2 blades
[types.FlatPoint]
grades = [2]
description = "Flat point (point pair with only infinity components)"
field_map = [
  { name = "ix", blade = "e14" },
  { name = "iy", blade = "e24" },
  { name = "oi", blade = "e34" }
]
