# 3D Projective Geometric Algebra (PGA)
# Cl(3,0,1) - 3 positive bases, 1 degenerate basis
#
# Point-based formulation where:
# - Grade 1 = Points (homogeneous coordinates)
# - Grade 2 = Lines (Plücker coordinates)
# - Grade 3 = Planes
# - Grade 0+2+4 = Motors (rigid transformations)
# - Grade 1+3 = Flectors (reflections)

[algebra]
complete = false
name = "projective3"
module_path = "projective::dim3"
description = "3D Projective Geometric Algebra"

[signature]
positive = ["e1", "e2", "e3"]
negative = []
zero = ["e0"]

# Note: Internal basis ordering is [e1, e2, e3, e0] with indices [0, 1, 2, 3].
# In blade notation, we use 1-based indices, so:
# - e1 → internal index 0
# - e2 → internal index 1
# - e3 → internal index 2
# - e4 → internal index 3 (this is the e0 basis in PGA convention)

[blades]
# Scalar (grade 0)
# (implicit)

# Vectors (grade 1) - represent points in homogeneous coordinates
e1 = "e1"
e2 = "e2"
e3 = "e3"
e4 = "e0"  # e4 is the degenerate basis, named e0 in PGA convention

# Bivectors (grade 2) - represent lines
# Euclidean bivectors (rotation part)
e23 = "e23"
e13 = "e31"  # Note: named e31 for PGA convention
e12 = "e12"
# Translation bivectors (e0 wedge ei)
e14 = "e01"
e24 = "e02"
e34 = "e03"

# Trivectors (grade 3) - represent planes
e234 = "e023"  # Note: named e023 for PGA convention
e134 = "e031"  # Note: named e031 for PGA convention
e124 = "e012"  # Note: named e012 for PGA convention
e123 = "e123"

# Quadvector (grade 4) - pseudoscalar
e1234 = "e0123"

# ============================================================
# Types
# ============================================================

[types.Scalar]
grades = [0]
field_map = [
  { name = "s", blade = "s" }
]

[types.Point]
grades = [1]
description = "3D point in homogeneous coordinates"
field_map = [
  { name = "x", blade = "e1" },
  { name = "y", blade = "e2" },
  { name = "z", blade = "e3" },
  { name = "w", blade = "e4" }
]

[types.Line]
grades = [2]
description = "3D line in Plücker coordinates"
# Blade order: e12 (moment_z), e13 (moment_y), e14 (dir_x), e23 (moment_x), e24 (dir_y), e34 (dir_z)
# The direction components (dir_x, dir_y, dir_z) represent the line's direction vector.
# The moment components (moment_x, moment_y, moment_z) represent the line's moment about the origin.
# Use the direction() and moment() helper methods for intuitive access.
field_map = [
  { name = "moment_z", blade = "e12" },
  { name = "moment_y", blade = "e13" },
  { name = "dir_x", blade = "e14" },
  { name = "moment_x", blade = "e23" },
  { name = "dir_y", blade = "e24" },
  { name = "dir_z", blade = "e34" }
]

[types.Plane]
grades = [3]
description = "3D plane"
# Blade order: e123 (dist), e124 (nz), e134 (ny), e234 (nx)
# The plane equation is: n.x + dist = 0, where n is the normal vector (nx, ny, nz)
field_map = [
  { name = "dist", blade = "e123" },
  { name = "nz", blade = "e124" },
  { name = "ny", blade = "e134" },
  { name = "nx", blade = "e234" }
]

[types.Quadvector]
grades = [4]
field_map = [
  { name = "ps", blade = "e1234" }
]

[types.Motor]
grades = [0, 2, 4]
description = "3D rigid transformation (rotation + translation)"
# Field names reflect what each component DOES, not which blade it is:
# - s: scalar coupling term
# - tz, ty, tx: translation components (e12 controls z, e13 controls y, e14 controls x)
# - rx, ry, rz: rotation components (e23 controls x-rot, e24 controls y-rot, e34 controls z-rot)
# - ps: pseudoscalar (identity for composition)
field_map = [
  { name = "s", blade = "s" },
  { name = "tz", blade = "e12" },
  { name = "ty", blade = "e13" },
  { name = "tx", blade = "e14" },
  { name = "rx", blade = "e23" },
  { name = "ry", blade = "e24" },
  { name = "rz", blade = "e34" },
  { name = "ps", blade = "e1234" }
]

[types.Flector]
grades = [1, 3]
description = "3D reflection/glide transformation"
# Grade 1: [e1, e2, e3, e4] → [px, py, pz, pw]
# Grade 3: [e123, e124, e134, e234] → [dist, nz, ny, nx]
# The point part (px, py, pz, pw) represents a point component.
# The plane part (dist, nz, ny, nx) represents a plane component.
field_map = [
  { name = "px", blade = "e1" },
  { name = "py", blade = "e2" },
  { name = "pz", blade = "e3" },
  { name = "pw", blade = "e4" },
  { name = "dist", blade = "e123" },
  { name = "nz", blade = "e124" },
  { name = "ny", blade = "e134" },
  { name = "nx", blade = "e234" }
]
